#!/usr/bin/env sh

if [ -z "$SSH_PRIVATE_KEY" ]; then
    if [ ! -f ~/.ssh/composer_rsa ]; then
        echo "Loading ofcs@ofcs-staging:.ssh/composer_rsa"

        if ! ( scp -q ofcs@ofcs-staging:.ssh/composer_rsa ~/.ssh/composer_rsa && chmod og-rwx ~/.ssh/composer_rsa ); then
            echo "Please set env SSH_PRIVATE_KEY or create the file ~/.ssh/composer_rsa"
            exit 1
        fi
    fi

    echo "Using ~/.ssh/composer_rsa"
    SSH_PRIVATE_KEY=$(cat ~/.ssh/composer_rsa)
    export SSH_PRIVATE_KEY
fi
